STACK SEGMENT
STA DB 50 DUP(?)
TOP EQU LENGTH STA
STACK ENDS
CODE SEGMENT
	ASSUME CS:CODE,SS:STACK
START:	
	MOV AX,TOP
	MOV SP, AX	
	MOV AL,80H
	MOV DX,0646H
	OUT DX,AL	
	PUSH DS
	MOV AX,0000H
	MOV DS,AX		
	MOV AX,OFFSET IRQ0
	ADD AX,0000H
	MOV SI,38H
	MOV [SI],AX
	MOV AX,CS
	MOV SI,3AH
	MOV [SI],AX
	MOV AX,0000H
	MOV DS,AX
	MOV AX,OFFSET IRQ1
	ADD AX,0000H
	MOV SI,3CH
	MOV [SI],AX
	MOV AX,CS
	MOV SI,3EH
	MOV [SI],AX
	POP DS
	CLI	
	MOV AL,13H
	MOV DX,20H
	OUT DX,AL;ICW1
	MOV AL,06H
	MOV DX,21H
	OUT DX,AL;ICW2
	MOV AL,01H
	MOV DX,21H
	OUT DX,AL;ICW4	
	MOV DX,21H
	MOV AL,3FH;OCW1
	OUT DX,AL
	STI
	CLI	
	MOV AL,13H
	MOV DX,20H
	OUT DX,AL;ICW1
	MOV AL,08H
	MOV DX,21H
	OUT DX,AL;ICW2
	MOV AL,01H
	MOV DX,21H
	OUT DX,AL;ICW4	
	MOV DX,21H
	MOV AL,3FH;OCW1
	OUT DX,AL
	STI
DSP:
	MOV AL,0FFH
	MOV DX,0642H
	OUT DX,AL
	JMP DSP
IRQ0:
	STI
	MOV CX,0FFFH
	LOOP $
	
AA1:MOV AL,0FH
	MOV DX,0642H
	OUT DX,AL
	LOOP AA1
	MOV DX,20H
	MOV AL,20H
	OUT DX,AL
	MOV CX,0FFFFH
	LOOP $
	MOV CX,0FFFFH
	LOOP $
	IRET
IRQ1:
	STI
	MOV CX,0FFFFH
	LOOP $
AA2:MOV AL,0F0H
	MOV DX,0642H
	OUT DX,AL
	LOOP AA2
	MOV DX,20H
	MOV AL,20H
	OUT DX,AL
	MOV CX,0FFFH
	LOOP $
	MOV CX,0FFFH
	LOOP $
	IRET
	CODE ENDS
	END START