
CODE SEGMENT 
	ASSUME CS:CODE
	
MAIN PROC FAR
	CLI 
	MOV AL,13H;ICW1
	MOV DX,0020H
	OUT DX,AL

	MOV AL,08H;ICW2 
	MOV DX,0021H
	OUT DX,AL
	
	MOV AL,03H;ICW4
	MOV DX,0021H
	OUT DX,AL
	
	MOV AL,2FH;0CW1
	MOV DX,0021H
	OUT DX,AL
	STI;初始化8259
	
	CLI 
	MOV AX,0
	MOV ES,AX
	MOV DI,38H
	MOV AX,OFFSET INTP6
	CLD 
	STOSW
	MOV AX,SEG INTP6
	STOSW
	STI;设置INTP6中断向量
	
	MOV AL,80H
	MOV DX,0606H
	OUT DX,AL;初始化8255
	
	CLI
		
L1: MOV AL,00H
	MOV DX,0640H
	OUT DX,AL;启动IN0通道
	
	PUSH CX
	AND CX,0000H
	MOV CX,05FH
P:  LOOP P
	POP CX
	STI
	
	MOV DX,0602H
	OUT DX,AL;输出转换值到LED
	
	JMP L1 
MAIN ENDP

INTP6 PROC FAR
	MOV DX,0640H
	IN AL,DX;获取IN0转换值
	IRET
INTP6 ENDP


CODE ENDS
	END
	