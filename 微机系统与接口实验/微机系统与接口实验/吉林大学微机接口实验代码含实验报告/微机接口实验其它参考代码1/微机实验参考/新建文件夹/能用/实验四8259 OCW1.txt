DATA	SEGMENT
DATA	ENDS
CODE 	SEGMENT
	ASSUME CS:CODE,DS:DATA
START:  
    MOV AX,DATA
	MOV DS,AX
	
	CLI 
	MOV AL,13H;ICW1
	OUT 20H,AL
	MOV AL,0AH;ICW2
	OUT 21H,AL
	MOV AL,03H;ICW4
	OUT 21H,AL
	MOV AL,2FH;OCW1
	OUT 21H,AL
	
	MOV AX,0
	MOV ES,AX;中断向量表段地址
	MOV DI,38H;中断向量表偏移地址
	MOV AX,OFFSET INTP6;中断服务程序偏移地址
	CLD
	STOSW
	MOV AX,SEG INTP6;中断服务程序段地址
	STOSW
	
	MOV AX,0
	MOV ES,AX
	MOV DI,3CH
	MOV AX,OFFSET INTP7
	CLD
	STOSW
	MOV AX,SEG INTP7
	STOSW
	STI
	
	;主程序使8255的B口输出，输出FFH，L0-L7指示灯亮
	MOV AL,80H
	MOV DX,0646H
	OUT DX,AL
A1:	MOV DX,0642H
	MOV AX,00FFH
	OUT DX,AX
	JMP A1
	MOV AH,4CH
	INT 21H


INTP6 	PROC NEAR
	MOV AL,0FH
	MOV DX,0642H
	OUT DX,AL
    MOV BX,00FFH
A2:	CALL DELAY
	DEC BX
	JNZ A2
	IRET
INTP6   ENDP

INTP7 	PROC NEAR
	MOV AX,00F0H
	MOV DX,0642H
	OUT DX,AX
	MOV BX,00FFH
A3:	CALL DELAY
	DEC BX
	JNZ A3
	IRET
INTP7   ENDP

DELAY   PROC NEAR
	PUSH CX
	MOV CX,1000
LOOP1: LOOP LOOP1	
	POP CX
	RET
DELAY   ENDP

CODE 	ENDS
	END START




 
