CODE SEGMENT
     ASSUME CS:CODE
START:
MOV DX,0600H ;DAC0832地址
MOV AL,00H ;AL为00H~0FFH间的任意数
OUT DX,AL

MOV DX,0646H
MOV AL,90H
OUT DX,AL

CLI
;设置中断向量
MOV AX,8
MOV DX,AX
MOV AX,OFFSET MIR6
MOV BX,0038H
MOV [BX],AX
MOV AX,SEG MIR6
MOV [BX+2],AX

MOV AL,11H
OUT 20H,AL
MOV AL,08H
OUT 21H,AL
MOV AL,04H
OUT 21H,AL
MOV AL,01H
OUT 21H,AL
MOV AL,2FH
OUT 21H,AL

STI

MOV BX,00H
MAIN:
MOV DX,0600H
MOV CX,05H

CMP BX,00H
JZ X1
CMP BX,01H
JZ X2
CMP BX,02H
JZ X3

CMP BX,04H
JZ X5
JMP MAIN ;主程序循环


X5:
MOV BX,00H
JMP MAIN

MIR6:
STI
INC BX
MOV AL,20H
OUT 20H,AL
IRET

X1: ;矩形波
CMP BX,01H
JZ X2
CMP BX,02H
JZ X3
CMP BX,03H
JZ X4
CMP BX,04H
JZ X5
MOV AL,00H ;输出低电平
OUT DX,AL
CALL DELAY
MOV AL,0FFH ;输出高电平
OUT DX,AL
CALL DELAY
LOOP X1
JMP MAIN

X2: ;锯齿波
Y1:
MOV AL,00H
OUT DX,AL
Y2:
INC AL
OUT DX,AL
MOV CX,0FFH ;延时不同的时间
Y3:
CMP BX,00H
JZ X1
CMP BX,02H
JZ X3
CMP BX,03H
JZ X4
CMP BX,04H
JZ X5
LOOP Y3
JMP Y2

X3: ;三角波
Z1:
MOV AL,00H
Z2:
CMP BX,00H
JZ X1
CMP BX,01H
JZ X2
CMP BX,03H
JZ X4
CMP BX,04H
JZ X5
OUT DX,AL
MOV CX,05FFH
A:
LOOP A
;CALL DELAY
INC AL
JNZ Z2
DEC AL
DEC AL
Z3:
OUT DX,AL
MOV CX,05FFH
B:
LOOP B
;CALL DELAY
DEC AL
JNZ Z3
JMP Z2

X4: ;阶梯波
A1:
MOV AL,00H
A2:
CMP BX,00H
JZ X1
CMP BX,01H
JZ X2
CMP BX,02H
JZ X3
CMP BX,04H
JZ X6
OUT DX,AL
CALL DELAY
ADD AL,040H
CMP AL,0FFH
JZ A1
JMP A2

X6:
MOV BX,00H
JMP MAIN




DELAY:
PUSH CX
PUSH AX
MOV CX,0FFH
A5:
MOV AX,0800H
A6:
DEC AX
JNZ A6
LOOP A5
POP AX
POP CX
RET

INT 21H
CODE ENDS
     END START