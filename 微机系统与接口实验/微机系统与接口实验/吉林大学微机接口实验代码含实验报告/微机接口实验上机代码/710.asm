M8251_DATA EQU 0600H
M8251_CON EQU 0602H
M8254_2 EQU 06C4H
M8254_CON EQU 06C6H

SSTACK SEGMENT STACK
	DW 64 DUP(?)
SSTACK ENDS

CODE SEGMENT
	ASSUME CS:CODE
START:
	MOV AX,0000H
	MOV DS,AX
	
	MOV AL,0B6H
	MOV DX,M8254_CON
	OUT DX,AL
	MOV AL,0CH
	MOV DX,M8254_2
	OUT DX,AL
	MOV AL,00H
	OUT DX,AL
	
	MOV DX,M8251_CON
	MOV AL,00H
	OUT DX,AL
	CALL DELAY
	
	MOV AL,40H
	OUT DX,AL
	CALL DELAY
	
	MOV AL,7EH
	OUT DX,AL
	CALL DELAY
	
	MOV AL,34H
	OUT DX,AL
	CALL DELAY
	
	MOV DI,4000H
	MOV SI,3000H
	MOV CX,000AH
	


A1:
	MOV DX,M8251_CON
	IN AL,DX
	AND AL,01H
	JZ A1

	
	MOV AL,[SI]
	MOV DX,M8251_DATA
	OUT DX,AL
	CALL DELAY
	
	MOV AL,37H
	MOV DX,M8251_CON
	OUT DX,AL
	CALL DELAY

A2:
	MOV DX,M8251_CON
	IN AL,DX
	AND AL,02H
	JZ A2
	MOV DX,M8251_DATA
	IN AL,DX
	MOV [DI],AL
	INC DI
	INC SI
	LOOP A1
	
	MOV AH,4CH
	INT 21H
	
DELAY:
	PUSH CX
	MOV CX,3000H
	LOOP $
	POP CX
	RET
CODE ENDS
	END START